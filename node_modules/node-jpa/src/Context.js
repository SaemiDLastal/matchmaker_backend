module.exports = class Context {
  constructor(connection, logger = false) {
    this._connection = connection
    this._logger = logger
  }

  async query(sql, values) {
    if (this._logger) {
      console.log('[sql]', sql, values ? values : '')
    }
    try {
      return await this._connection.query(sql, values)
    } catch (e) {
      console.error('[sql]', sql, values ? values : '')
      throw e
    }
  }

  async beginTransaction() {
    return await this._connection.beginTransaction()
  }

  async commit() {
    return await this._connection.commit()
  }

  async rollback() {
    return await this._connection.rollback()
  }

  release() {
    this._connection.release()
  }
}
